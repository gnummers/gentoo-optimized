# Copyright 1999-2018 Gentoo Authors
# Distributed under the terms of the GNU General Public License v2

EAPI=6

# ebuild generated by hackport 0.5.4.9999

CABAL_FEATURES="lib profile haddock hoogle hscolour test-suite"
inherit haskell-cabal

DESCRIPTION="Prelude based on protolude for GHC 8 and beyond"
HOMEPAGE="https://gitlab.com/theunixman/liblawless"
SRC_URI="https://hackage.haskell.org/package/${P}/${P}.tar.gz"

LICENSE="GPL-3"
SLOT="0/${PV}"
KEYWORDS="~amd64 ~x86"
IUSE=""

RESTRICT=test # Tests/TestTime.hs: hGetContents: invalid argument (invalid byte sequence)

RDEPEND=">=dev-haskell/aeson-1.0.0:=[profile?]
	>=dev-haskell/base-unicode-symbols-0.2.2:=[profile?] <dev-haskell/base-unicode-symbols-0.3:=[profile?]
	>=dev-haskell/boomerang-1.4.5.2:=[profile?] <dev-haskell/boomerang-1.5:=[profile?]
	>=dev-haskell/containers-unicode-symbols-0.3.1:=[profile?] <dev-haskell/containers-unicode-symbols-0.4:=[profile?]
	>=dev-haskell/contravariant-1.4:=[profile?]
	>=dev-haskell/data-textual-0.3.0:=[profile?] <dev-haskell/data-textual-0.4:=[profile?]
	>=dev-haskell/dns-2.0.8:=[profile?]
	>=dev-haskell/exceptions-0.8.3:=[profile?]
	>=dev-haskell/hjsonschema-1.6.2:=[profile?] <dev-haskell/hjsonschema-1.9:=[profile?]
	>=dev-haskell/lawless-concurrent-machines-0.2.3.3:=[profile?] <dev-haskell/lawless-concurrent-machines-0.5:=[profile?]
	>=dev-haskell/lens-4.14:=[profile?]
	>=dev-haskell/lifted-async-0.9.1.1:=[profile?]
	>=dev-haskell/lifted-base-0.2.3:=[profile?] <dev-haskell/lifted-base-0.3:=[profile?]
	>=dev-haskell/machines-0.6.1:=[profile?] <dev-haskell/machines-0.7:=[profile?]
	>=dev-haskell/managed-1.0.5:=[profile?] <dev-haskell/managed-1.1:=[profile?]
	>=dev-haskell/monad-control-1.0.1.0:=[profile?] <dev-haskell/monad-control-1.1:=[profile?]
	>=dev-haskell/mtl-2.2.1:=[profile?] <dev-haskell/mtl-2.3:=[profile?]
	>=dev-haskell/network-2.6.3.1:=[profile?]
	>=dev-haskell/network-ip-0.3:=[profile?] <dev-haskell/network-ip-0.4:=[profile?]
	>=dev-haskell/parsers-0.12.4:=[profile?] <dev-haskell/parsers-0.13:=[profile?]
	>=dev-haskell/pathtype-0.8:=[profile?] <dev-haskell/pathtype-0.9:=[profile?]
	>=dev-haskell/protolude-0.1.10:=[profile?] <dev-haskell/protolude-0.4:=[profile?]
	>=dev-haskell/quickcheck-2.8:2=[profile?]
	>=dev-haskell/random-1.1:=[profile?] <dev-haskell/random-1.2:=[profile?]
	>=dev-haskell/semigroups-0.18.2:=[profile?] <dev-haskell/semigroups-0.19:=[profile?]
	>=dev-haskell/stm-2.4.4:=[profile?]
	>=dev-haskell/stm-chans-3.0.0.4:=[profile?] <dev-haskell/stm-chans-3.1:=[profile?]
	>=dev-haskell/stm-containers-0.2.15:=[profile?] <dev-haskell/stm-containers-0.3:=[profile?]
	>=dev-haskell/temporary-1.2.0:=[profile?]
	>=dev-haskell/text-1.2.2:=[profile?] <dev-haskell/text-1.3:=[profile?]
	>=dev-haskell/text-printer-0.4:=[profile?]
	>=dev-haskell/transformers-base-0.4.4:=[profile?] <dev-haskell/transformers-base-0.5:=[profile?]
	>=dev-haskell/zippers-0.2.2:=[profile?] <dev-haskell/zippers-0.3:=[profile?]
	>=dev-lang/ghc-8.0.1:=
"
DEPEND="${RDEPEND}
	>=dev-haskell/cabal-1.24.0.0
	test? ( >=dev-haskell/temporary-1.2.0.4
		dev-haskell/test-framework
		dev-haskell/test-framework-quickcheck2
		dev-haskell/test-framework-th )
"

PATCHES=(
	"${FILESDIR}"/${PN}-0.26.0-aeson-1.0.0.patch
	"${FILESDIR}"/${PN}-0.26.0-dns-3.0.0.patch
	"${FILESDIR}"/${PN}-0.26.0-ghc84.patch
)

src_prepare() {
	default

	cabal_chdeps \
		'QuickCheck                 >= 2.8 && < 2.10' 'QuickCheck                 >= 2.8' \
		'dns                        >= 2.0.8 && < 2.1' 'dns                        >= 2.0.8' \
		'exceptions                 >= 0.8.3 && < 0.9' 'exceptions                 >= 0.8.3' \
		'lens                       >= 4.14 && < 4.16' 'lens                       >= 4.14' \
		'lifted-async  >= 0.9.1.1 && < 0.10' 'lifted-async  >= 0.9.1.1' \
		'text-printer               >= 0.4 && < 0.5' 'text-printer               >= 0.4' \
		'contravariant              >= 1.4 && < 1.5' 'contravariant              >= 1.4' \
		'stm                        >= 2.4.4 && < 2.5' 'stm                        >= 2.4.4' \
		'containers                 >= 0.5.7 && < 0.6' 'containers                 >= 0.5.7'\
		'network                    >= 2.6.3.1 && < 2.7' 'network >=2.6.3.1'\
		'temporary                  >= 1.2.0 && < 1.3' 'temporary >= 1.2.0'
}
