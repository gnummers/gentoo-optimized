diff -uNr dhcp-3.1.2.ORIG/server/dhcp.c dhcp-3.1.2/server/dhcp.c
--- dhcp-3.1.2.ORIG/server/dhcp.c	2009-07-13 14:26:15.000000000 +0100
+++ dhcp-3.1.2/server/dhcp.c	2009-07-13 14:26:33.000000000 +0100
@@ -1747,6 +1747,8 @@
 				host_reference (&host, h, MDL);
 		}
 		if (!host) {
+			if (hp)
+				host_dereference (&hp, MDL);
 			find_hosts_by_haddr (&hp,
 					     packet -> raw -> htype,
 					     packet -> raw -> chaddr,
