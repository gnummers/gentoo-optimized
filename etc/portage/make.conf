source make.conf.lto

USE="a52 aac -accessibility acl acpi alsa amd64 asm avx bash-completion bcache berkdb -bindist blksha1 -bluetooth boost \
branding bzip2 cairo caps ccache cdda cdr cli -consolekit contrib corefonts crypt -cuda -cups curl custom-cflags \
custom-optimization custom-tune cxx daemon dbus -debug device-mapper dev-libs dhcpcd dmraid -doc dri dri3 dts dvd dvdr \
eclipse elibc_glibc -elogind emboss encode eselect -examples exif expat fbcon ffmpeg flac flambda fontconfig fortran fpm \
gcrypt gd gdbm gif git glamor gmp go gold gpm graphite gstreamer gtk gtk3 gtk4 guile gzip handbook hddtemp hscolour \
hwloc iconv icu idn infinality initramfs inotify -ipv6 -java jemalloc jit jpeg jpeg2k json jsonc kde kernel_linux \
lame latex lcms -ldap libnotify libsamplerate libssh libtirpc lm-sensors lm_sensors lock loongson2f lrzip lto lv4 lz4 \
lzma lzo mad matroska mdadm mime -minimal mmap mmx mmxext mng mono mp3 mp4 mpeg mpi multilib multitarget ncurses \
-networkmanager nlopt -nls nptl nscd -numa nvidia offensive offload ogg oil openal opencl opengl openmp optimizations \
optimize orc -oss override-flagomatic pam pango pch pclmul pcre pdf perl pgo pic -pie png policykit popcnt ppds profile \
profiler profiling pulseaudio pypy3 python qt5 rar rdesktop -rdoc readline resize-optimization r_suggests_spacetime ruby \
-samba sasl sctp sdl seccomp -semantic-desktop session -smartcard smp sndfile snmp sockets socks5 sound source spacetime \
spell split-usr sqlite ssh ssl -ssp startup-notification -static -static-libs svg syslog system-bzip2 systemd \
system-harfbuzz system-icu system-jpeg system-libevent system-libvpx system-libwebp system-lua system-sqlite systemtap \
system-zlib szip tcl tcmalloc tcpd telemetry -telnet -test text theora threads thunar tidy tiff tk -tls-heartbeat tools \
truetype twolame udev udisks unicode unzip upnp upnp-av upower -usb userland_GNU usr-portage util utils uvm vaapi vdo \
vdpau vhosts vim vim-syntax vnc vorbis vpx vulkan webkit webp webui wmf wxwidgets X x264 x265 xattr xcb xcomposite xface \
xft xine xinetd xla xml xmlrpc xmpp xorg xpm xscreensaver xv xvid xz zeroconf zip zlib zsh zsh-completion zstd"

ADA_TARGET="gnat_2018"

APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_core authn_dbm authn_default authn_file \
authz_core authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs \
dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache \
mime mime_magic negotiation rewrite setenvif socache_shmcb speling status unique_id unixd userdir usertrack vhost_alias"

CALLIGRA_FEATURES="karbon sheets words"
COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog"

GPSD_PROTOCOLS="aivdm ashtech earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 navcom nmea \
ntrip oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tnt tripmate tsip ublox ubx"

LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text"
LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer"
OFFICE_IMPLEMENTATION="libreoffice"
PHP_TARGETS="php7-2"
POSTGRES_TARGETS="postgres10 postgres11"

XTABLES_ADDONS="account chaos condition delude dhcpmac fuzzy geoip iface ipmark ipp2p ipset ipv4options length2 logmark \
lscan pknock psd quota2 rawnat steal sysrq tarpit tee"

#BINPKG_COMPRESS_FLAGS="-cze9 --threads=12 --suffix=.xz --best -" # xz
#BINPKG_COMPRESS_FLAGS="-zvvU -L 9 -p 12 --nice-level -19 -" # lrzip
#BINPKG_COMPRESS_FLAGS="-p 12 -c -z -q --ultra -T0 -22 -" # zstd
#BINPKG_COMPRESS="${PORTAGE_COMPRESS}"
#BINPKG_COMPRESS_FLAGS="${PORTAGE_COMPRESS_FLAGS}"
#PORTAGE_COMPRESS="pbzip2"
#PORTAGE_COMPRESS_FLAGS="-9vk -p12 -l12 -m1024"
#PORTAGE_BZIP2_COMMAND="${PORTAGE_COMPRESS}"
#PORTAGE_BUNZIP2_COMMAND="pbunzip2"
#PORTAGE_COMPRESSION_COMMAND="${PORTAGE_COMPRESS}"
#PORTAGE_COMPRESSION_COMMAND="${PORTAGE_COMPRESS} ${PORTAGE_COMPRESS_FLAGS}"

ABI_X86="64"
#ABI_X86="64 32"
ACCEPT_KEYWORDS="~amd64"
#ACCEPT_KEYWORDS="**" # The maddening siren's call to emerge from git system-wide...
ACCEPT_LICENSE="*"
ALSA_CARDS="hda-intel nvidia nv dummy"

# below can be found in makepkg-optimize's insane and unsafe rice flags on archlinux
ARCHLINUX_RICE="-fbranch-target-load-optimize2 -fcx-fortran-rules -fipa-pta -fno-enforce-eh-specs -fnothrow-opt \
-fno-var-tracking-assignments -freschedule-modulo-scheduled-loops -fsched-pressure -fsched-spec-load \
-fsched-spec-load-dangerous -fsched-stalled-insns=0 -fsched2-use-superblocks -fselective-scheduling \
-fselective-scheduling2 -fsel-sched-pipelining -fsel-sched-pipelining-outer-loops -ftree-lrs \
-maccumulate-outgoing-args -fmerge-all-constants"

BOOT_CFLAGS="${CFLAGS}"
BOOTSTRAP_USE="${BOOTSTRAP_USE} systemd udev"
CCACHE_DIR="/tmp/ccache"

CFLAGS="${CFLAGS}" # -fprofile-arcs -ftest-coverage -fprofile-abs-path -fbranch-probabilities -fprofile-generate
# -fprofile-arcs -ftest-coverage -fprofile-abs-path -fbranch-probabilities -fprofile-dir=/tmp/portage/pgo -g0
# -falign-functions=32 -fprofile-use -fprofile-correction

CHOST="x86_64-pc-linux-gnu"
CMAKE_C_COMPILER="command gcc $CFLAGS"
CMAKE_CXX_COMPILER="command g++ $CXXFLAGS"
CMAKE_LINKER="command ld $LDFLAGS"
CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sha sse sse2 sse3 sse4_1 sse4_2 sse4a ssse3"
CXXFLAGS="${CFLAGS}"
DISTDIR="${PORTDIR}/distfiles"
#EGIT3_STORE_DIR="/tmp"
#EGIT_STORE_DIR="/tmp"

#EMERGE_DEFAULT_OPTS="--ask --ask-enter-invalid --autounmask-backtrack=y --autounmask=y --binpkg-respect-use=y \
#--buildpkg=y --buildpkg-exclude=virtual/* --keep-going=n --load-average=12.0 --quiet-fail=n --verbose --verbose-conflicts \
#--with-bdeps=y --with-test-deps=n" # --changed-deps y --changed-deps-report y --fail-clean y --newrepo
EMERGE_DEFAULT_OPTS="--ask --ask-enter-invalid --autounmask-backtrack=y --autounmask=y \
--binpkg-respect-use=y --buildpkg-exclude=virtual/* --buildpkg=y --complete-graph=y --keep-going=y --quiet-fail=y \
--verbose --verbose-conflicts --with-bdeps=y --with-test-deps=n --jobs 8 --load-average 12.0" # --backtrack=200

#ESVN_STORE_DIR="/tmp"
EXTRA_FFMPEG_CONF="--enable-lto"
FCFLAGS="${CFLAGS}"

# FEATURES="news nodoc -cgroup -ccache -collision-protect -protect-owned multilib-strict userpriv -sandbox \
# -usersandbox usersync userfetch binpkg-logs -compress-index -downgrade-backup parallel-fetch \
# -parallel-install -ebuild-locks -unmerge-backup unmerge-logs xattr" # buildpkg binpkg-multi-instance

FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs cgroup ccache -collision-protect -protect-owned -sandbox -usersandbox compress-index config-protect-if-modified distlocks fixlafiles -ipc-sandbox merge-sync multilib-strict network-sandbox news nodoc parallel-fetch -pid-sandbox preserve-libs qa-unresolved-soname-deps sfperms strict strict-keepdir unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersync xattr"

FFLAGS="${CFLAGS}"
GENTOO_MIRRORS="https://ftp.fau.de/gentoo"
GRUB_PLATFORMS="pc efi-64"
INPUT_DEVICES="keyboard mouse evdev libinput"
L10N="en en_US en-US"
LC_MESSAGES=C

LDFLAGS="-Wl,-O4,--sort-common,--as-needed,-z,norelro,-z,now"
#LDFLAGS="-Wl,-O4,--sort-common,--as-needed,-z,norelro,-z,now,-lgomp,-lpthread -s"
# -fuse-linker-plugin --hash-style=gnu -shared -lgcov --coverage

LINGUAS="en en_US"
LLVM_TARGETS="AMDGPU BPF NVPTX X86 AArch64 ARM WebAssembly XCore"
LUA_TARGETS="lua53"
MAKEOPTS="-j12 -l12"
NGINX_MODULES_HTTP="access fastcgi gzip proxy rewrite"
_NO_SSP="-fno-stack-protector -fno-stack-clash-protection -fstack-check=no -fno-stack-check"
PKGDIR="${PORTDIR}/packages"
PORTAGE_BINHOST="http://packages.gentooexperimental.org/packages/amd64-unstable/"
PORTAGE_ELOG_CLASSES="qa warn"
PORTAGE_GPG_DIR="/etc/portage/gpg"
#PORTAGE_IONICE_COMMAND="ionice -c 3 -p \${PID}"
PORTAGE_NICENESS="-19"
PORTAGE_TMPDIR="/tmp"
PORTDIR_OVERLAY="/usr/local/portage"
PORTDIR="/usr/portage"
PORT_LOGDIR="/var/log/emerge-log"
PYTHON_SINGLE_TARGET="python3_8"
PYTHON_TARGETS="python3_8 python3_9 python3_7 python3_6 python2_7 pypy3"
QEMU_SOFTMMU_TARGETS="x86_64 aarch64 arm"
QEMU_USER_TARGETS="x86_64 aarch64 arm"
RUBY_TARGETS="ruby27 ruby26 ruby25"
RUSTFLAGS="-Ctarget-cpu=native"
VIDEO_CARDS="nv nvidia vesa fbdev nouveau dummy v4l"
